<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{client/layout/head::head}"></head>
<body>>

<!-- header section start -->
<header th:replace="~{client/layout/header::header}"></header>
<!-- header section end -->
<!-- pages-title-start -->
<div class="pages-title section-padding">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="pages-title-text text-center">
                    <h2>Cart</h2>
                    <ul class="text-left">
                        <li><a th:href="@{/}">Home </a></li>
                        <li><span> // </span>Cart</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- pages-title-end -->
<!-- cart content section start -->
<section class="pages cart-page section-padding">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div th:if="${check}" class="text-center alert-warning">
                    <p th:text="${check}"></p>
                </div>
                <div class="table-responsive padding60" th:if="${check == null}">
                    <table class="wishlist-table text-center">
                        <thead>
                        <tr>
                            <th>Product</th>
                            <th>Price</th>
                            <th>quantity</th>
                            <th>Total Price</th>
                            <th>Remove</th>
                        </tr>
                        </thead>
                        <tbody th:if="${cartDetails.empty}">
                            <tr>
                                <td colspan="5">Danh sách trống</td>
                            </tr>
                        </tbody>
                        <tbody>
                        <tr th:each="cartDetail : ${cartDetails}">
                            <td class="td-img text-left">
                                <a th:href="@{/single-product/__${cartDetail.productDetail.product.id}__}">
                                    <img th:src="${cartDetail.productDetail.product.images[0].urlImage}" alt="Add Product" />
                                </a>
                                <div class="items-dsc">
                                    <h5><a href="#" th:text="${cartDetail.productDetail.product.name}"></a></h5>
                                    <p class="itemcolor" >
                                        Color : <span th:text="${cartDetail.productDetail.color.name}"></span>
                                    </p>
                                    <p class="itemcolor">
                                        Size   : <span th:text="${cartDetail.productDetail.size.name}"></span>
                                    </p>
                                </div>
                            </td>
                            <td th:text="${cartDetail.productDetail.price}" class="price"></td>
                            <td>
                                <form th:action="@{/cart/update/{id}(id=${cartDetail.productDetail.id})}" method="post">
                                    <div class="plus-minus">
                                        <button class="dec qtybutton btn btn-outline-secondary" type="submit"
                                                onclick="decrement_${cartDetail.productDetail.id}()"
                                                style="height: 34px;">-</button>
                                        <input type="number" th:value="${cartDetail.quantity}"
                                               id="quantity_${cartDetail.productDetail.id}"
                                               min="0" max="${cartDetail.productDetail.quantity}"
                                               step="1" name="quantity" class="plus-minus-box">
                                        <button class="inc qtybutton btn btn-outline-secondary" type="submit"
                                                onclick="increment_${cartDetail.productDetail.id}()"
                                                style="height: 34px;">+</button>
                                    </div>
                                </form>
                                <script>
                                    function decrement_${cartDetail.productDetail.id}() {
                                        var quantityInput = document.getElementById("quantity_${cartDetail.productDetail.id}");
                                        var currentValue = parseInt(quantityInput.value);
                                        if (currentValue > 1) {
                                            quantityInput.value = currentValue - 1;
                                        }
                                    }
                                    function increment_${cartDetail.productDetail.id}() {
                                        var quantityInput = document.getElementById("quantity_${cartDetail.productDetail.id}");
                                        var currentValue = parseInt(quantityInput.value);
                                        var maxValue = parseInt(quantityInput.getAttribute('max'));

                                        if (currentValue < maxValue) {
                                            quantityInput.value = currentValue + 1;
                                        }
                                    }
                                </script>
                            </td>
                            <td>
                                <strong th:text="${cartDetail.productDetail.price * cartDetail.quantity}" id="totalPrice"></strong>
                            </td>
                            <td>
                                <a th:href="@{/cart/{id}(id=${cartDetail.productDetail.id})}">
                                    <i class="mdi mdi-close" title="Remove this product"></i>
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row margin-top">
            <div class="col-md-6">
                <div class="single-cart-form padding60">
                    <div class="log-title">
                        <h3><strong>coupon discount</strong></h3>
                    </div>
                    <div class="cart-form-text custom-input">
                        <p>Enter your coupon code if you have one!</p>
                        <form action="#">
                            <input type="text" name="subject" placeholder="Enter your code here..." />
                            <div class="submit-text coupon">
                                <button type="submit">apply coupon </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="single-cart-form padding60">
                    <div class="log-title">
                        <h3><strong>payment details</strong></h3>
                    </div>
                    <div class="cart-form-text pay-details table-responsive">
                        <table>
                            <tbody>
                            <tr>
                                <th>Cart Subtotal</th>
                                <td th:text="${sumPrice}" id="sumPrice"></td>
                            </tr>
                            <script>
                                var tongTienElement = document.getElementById("sumPrice");
                                var tongTienText = tongTienElement.innerText;
                                var formattedTongTien = parseInt(tongTienText.replace(/[^\d]/g, '')).toLocaleString('en-US');
                                tongTienElement.innerText = formattedTongTien + " VNĐ";
                            </script>
                            <tr>
                                <th>Shipping and Handing</th>
                                <td>$15.00</td>
                            </tr>
                            <tr>
                                <th>Vat</th>
                                <td>$00.00</td>
                            </tr>
                            </tbody>
                            <tfoot>
                            <tr>
                                <th class="tfoot-padd">Order total</th>
                                <td class="tfoot-padd">$170.00</td>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- cart content section end -->
<!-- footer section start -->
<div th:replace="~{client/layout/footer::footer}"></div>
<!-- footer section end -->

<!-- all js here -->
<!-- jquery latest version -->
<div th:replace="~{client/layout/script::script}"></div>
</body>

</html>
